<!DOCTYPE html>
<html>
<head>
    <title>Post a Job Opening</title>
    <link rel="stylesheet" href="../base.css">
    <link rel="stylesheet" href="jobnoticecss.css"/>
    <script>
        function checkDeadline() {
            var deadline = document.getElementById("deadline").value;
            var currentDate = new Date().toISOString().slice(0, 10); // Format: YYYY-MM-DD
            if(deadline && currentDate > deadline) {
                document.getElementById("jobForm").style.display = "none";
                document.getElementById("closedMsg").style.display = "block";
            } else {
                document.getElementById("jobForm").style.display = "block";
                document.getElementById("closedMsg").style.display = "none";
            }
        }
    </script>
</head>
<body>
     <header class="header">
        <div class="user-actions">
    <a href="../jobs.html" class="btn-text">Jobs</a>
    <a href="../services.html" class="btn-text">Services</a>
    <a href="../profile.html" class="btn-text">Profile</a>
    <a href="../applicant/applicant-login.html" class="btn btn-secondary">Login</a>
    <a href="../applicant/applicant-register.html" class="btn btn-primary">Register</a>
    <a href="employer-login.html" class="btn btn-secondary">Employers Login</a>
    <a href="employer-register.html" class="btn btn-primary">Employers register</a>
  </div>
    </header>
    <h2>Post a Job / Hiring Notice</h2>
    <form id="jobForm" method="post" action="/submit-job" enctype="multipart/form-data">
        <label for="title">Job Title:</label>
        <input type="text" id="title" name="title" required><br><br>

        <label for="desc">Job Description:</label><br>
        <textarea id="desc" name="desc" rows="5" cols="40" required></textarea><br><br>

        <label for="req">Requirements:</label><br>
        <textarea id="req" name="req" rows="3" cols="40"></textarea><br><br>

        <label for="location">Location:</label>
        <input type="text" id="location" name="location" required><br><br>

        <label for="email">Contact Email:</label>
        <input type="email" id="email" name="email" required><br><br>

        <label for="deadline">Application Deadline:</label>
        <input type="date" id="deadline" name="deadline" required onchange="checkDeadline()"><br><br>
        
        <label for="upload">Attach Job Notice (optional):</label>
        <input type="file" id="upload" name="upload"><br><br>

        <input type="submit" value="Post Job">
    </form>

    <div id="closedMsg" style="display:none; color:red; font-weight:bold;">
        Applications Closed
    </div>

    <script>
        // Save job details to localStorage when form is submitted
document.getElementById("jobForm").addEventListener("submit", function(event) {
  event.preventDefault();

  // Collect form data
  var job = {
    title: document.getElementById("title").value,
    desc: document.getElementById("desc").value,
    req: document.getElementById("req").value,
    location: document.getElementById("location").value,
    email: document.getElementById("email").value,
    deadline: document.getElementById("deadline").value
    // Note: file upload cannot be stored in localStorage
  };

  // Optionally, assign company name from loggedInEmployer (if available)
  var employer = JSON.parse(localStorage.getItem("loggedInEmployer") || "{}");
  job.company_name = employer.companyName || "HR Job Notice";

  // Get all jobs from storage or start empty
  var jobs = JSON.parse(localStorage.getItem("jobNotices") || "[]");
  jobs.push(job);

  localStorage.setItem("jobNotices", JSON.stringify(jobs));
  alert("Job posted successfully!");

  document.getElementById("jobForm").reset();
});

        window.onload = checkDeadline;
    </script>
</body>
</html>
